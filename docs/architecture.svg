<?xml version="1.0" encoding="utf-8" ?>
<svg baseProfile="full" height="1050px" version="1.1" width="1400px" xmlns="http://www.w3.org/2000/svg" xmlns:ev="http://www.w3.org/2001/xml-events" xmlns:xlink="http://www.w3.org/1999/xlink">
  <defs>
    <!-- Modern Gradients and Shadows -->
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#f8fafc" />
      <stop offset="100%" stop-color="#f1f5f9" />
    </linearGradient>
    <linearGradient id="coreGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#eff6ff" />
      <stop offset="100%" stop-color="#dbeafe" />
    </linearGradient>
    <linearGradient id="executionGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#f0fdf4" />
      <stop offset="100%" stop-color="#dcfce7" />
    </linearGradient>
    <linearGradient id="dataGradient" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" stop-color="#faf5ff" />
      <stop offset="100%" stop-color="#f3e8ff" />
    </linearGradient>
    <linearGradient id="nodeGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" stop-color="#ffffff" />
      <stop offset="100%" stop-color="#f8fafc" />
    </linearGradient>
    
    <filter id="dropShadow" x="-10%" y="-10%" width="120%" height="120%">
      <feDropShadow dx="0" dy="8" stdDeviation="6" flood-color="#0f172a" flood-opacity="0.08" />
    </filter>
    <filter id="softShadow" x="-5%" y="-5%" width="110%" height="110%">
      <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#0f172a" flood-opacity="0.05" />
    </filter>

    <marker id="arrow" markerHeight="8" markerWidth="8" orient="auto" refX="8" refY="4">
      <path d="M0,0 L8,4 L0,8 L2,4 Z" fill="#64748b" />
    </marker>
    <marker id="arrowSolid" markerHeight="8" markerWidth="8" orient="auto" refX="8" refY="4">
      <path d="M0,0 L8,4 L0,8 Z" fill="#3b82f6" />
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1400" height="1050" fill="url(#bgGradient)" />

  <!-- Title Section -->
  <text x="700" y="80" fill="#0f172a" font-family="'Inter', -apple-system, sans-serif" font-size="36" font-weight="800" text-anchor="middle" letter-spacing="-0.5">Autonomous Trading Agent</text>
  <text x="700" y="110" fill="#64748b" font-family="'Inter', -apple-system, sans-serif" font-size="16" font-weight="400" text-anchor="middle" letter-spacing="0.5">System Architecture &amp; Data Flow</text>

  <!-- ========================================== -->
  <!-- ZONE 1: EXTERNAL INTERFACES (TOP)          -->
  <!-- ========================================== -->
  <g transform="translate(460, 160)">
    <rect width="480" height="90" rx="12" fill="none" stroke="#cbd5e1" stroke-width="2" stroke-dasharray="8 4" />
    <text x="240" y="-12" fill="#64748b" font-family="sans-serif" font-size="12" font-weight="600" text-anchor="middle" letter-spacing="1">USER INTERFACES</text>
    
    <!-- User / Browser Node -->
    <rect x="40" y="20" width="160" height="50" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="120" y="42" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">User Browser</text>
    <text x="120" y="58" fill="#64748b" font-family="sans-serif" font-size="10" text-anchor="middle">Port 8050</text>

    <!-- SPA Node -->
    <rect x="280" y="20" width="160" height="50" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="360" y="42" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Dashboard SPA</text>
    <text x="360" y="58" fill="#64748b" font-family="sans-serif" font-size="10" text-anchor="middle">Vanilla JS / HTML5</text>
    
    <path d="M200,45 L272,45" fill="none" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)" />
  </g>

  <!-- ========================================== -->
  <!-- ZONE 2: CORE BACKEND (MIDDLE)              -->
  <!-- ========================================== -->
  <rect x="80" y="320" width="900" height="520" rx="16" fill="url(#coreGradient)" stroke="#93c5fd" stroke-width="2" filter="url(#dropShadow)" />
  <text x="110" y="360" fill="#1e3a8a" font-family="sans-serif" font-size="20" font-weight="800" letter-spacing="-0.5">Core Agent Intelligence</text>

  <!-- FastAPI -->
  <g transform="translate(460, 310)">
    <rect x="280" y="0" width="160" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#bfdbfe" stroke-width="2" />
    <text x="360" y="25" fill="#1e40af" font-family="sans-serif" font-size="14" font-weight="700" text-anchor="middle">FastAPI Backend</text>
    <text x="360" y="45" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">dashboard_api.py</text>
  </g>

  <!-- Orchestrator -->
  <g transform="translate(440, 420)">
    <rect x="0" y="0" width="180" height="70" rx="8" fill="#2563eb" filter="url(#softShadow)" />
    <text x="90" y="30" fill="#ffffff" font-family="sans-serif" font-size="15" font-weight="800" text-anchor="middle">Orchestrator</text>
    <text x="90" y="50" fill="#bfdbfe" font-family="sans-serif" font-size="11" text-anchor="middle">main.py (Event Loop)</text>
  </g>
  
  <!-- Backtest Engine -->
  <g transform="translate(140, 420)">
    <rect x="0" y="0" width="160" height="70" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#94a3b8" stroke-width="1.5" stroke-dasharray="4 2" />
    <text x="80" y="30" fill="#334155" font-family="sans-serif" font-size="14" font-weight="700" text-anchor="middle">Backtest Engine</text>
    <text x="80" y="50" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">backtest.py</text>
  </g>

  <!-- External Data Connectors -->
  <g transform="translate(140, 560)">
    <rect x="0" y="0" width="160" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="80" y="25" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Market Data</text>
    <text x="80" y="45" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">yfinance / News</text>
    
    <rect x="0" y="80" width="160" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="80" y="105" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">FX Normalizer</text>
    <text x="80" y="125" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">USD/INR Live Rates</text>
  </g>

  <!-- Strategy Engine Core -->
  <g transform="translate(440, 560)">
    <rect x="0" y="-10" width="460" height="230" rx="12" fill="none" stroke="#60a5fa" stroke-width="1.5" stroke-dasharray="6 3" />
    <text x="230" y="15" fill="#2563eb" font-family="sans-serif" font-size="16" font-weight="700" text-anchor="middle">Strategy Engine (engine.py)</text>
    
    <rect x="40" y="40" width="160" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="120" y="65" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Macro Agent</text>
    <text x="120" y="85" fill="#ef4444" font-family="sans-serif" font-size="11" font-weight="600" text-anchor="middle">Circuit Breaker</text>
    
    <rect x="260" y="40" width="160" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="340" y="65" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">AI Analyst</text>
    <text x="340" y="85" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">LLM Technical/News</text>

    <rect x="40" y="130" width="160" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="120" y="155" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Risk Manager</text>
    <text x="120" y="175" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">Devil's Advocate</text>

    <rect x="260" y="130" width="160" height="60" rx="8" fill="#fef3c7" filter="url(#softShadow)" stroke="#fbbf24" stroke-width="1.5" />
    <text x="340" y="155" fill="#b45309" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Trade Signal</text>
    <text x="340" y="175" fill="#d97706" font-family="sans-serif" font-size="11" text-anchor="middle">Allocated JSON</text>
    
    <!-- Internal Engine Links -->
    <path d="M200,70 L252,70" fill="none" stroke="#cbd5e1" stroke-width="2" marker-end="url(#arrow)" />
    <path d="M340,100 L340,122" fill="none" stroke="#cbd5e1" stroke-width="2" marker-end="url(#arrow)" />
    <path d="M200,160 L252,160" fill="none" stroke="#cbd5e1" stroke-width="2" marker-end="url(#arrow)" />
  </g>


  <!-- ========================================== -->
  <!-- ZONE 3: EXECUTION LAYER (RIGHT)            -->
  <!-- ========================================== -->
  <rect x="1030" y="320" width="310" height="520" rx="16" fill="url(#executionGradient)" stroke="#86efac" stroke-width="2" filter="url(#dropShadow)" />
  <text x="1060" y="360" fill="#166534" font-family="sans-serif" font-size="20" font-weight="800" letter-spacing="-0.5">Execution Layer</text>

  <g transform="translate(1100, 420)">
    <rect x="0" y="0" width="180" height="70" rx="8" fill="#10b981" filter="url(#softShadow)" />
    <text x="90" y="30" fill="#ffffff" font-family="sans-serif" font-size="15" font-weight="800" text-anchor="middle">Broker Router</text>
    <text x="90" y="50" fill="#a7f3d0" font-family="sans-serif" font-size="11" text-anchor="middle">Auto Region Selection</text>
    
    <rect x="0" y="140" width="180" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="90" y="165" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Robinhood (US)</text>
    <text x="90" y="185" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">robin_stocks</text>
    
    <rect x="0" y="230" width="180" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="90" y="255" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">Zerodha / ICICI (IN)</text>
    <text x="90" y="275" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">kiteconnect / breeze</text>
    
    <path d="M90,70 L90,110 L90,132" fill="none" stroke="#6ee7b7" stroke-width="2" marker-end="url(#arrow)" />
    <path d="M90,110 L-60,110 L-60,260 L-8,260" fill="none" stroke="#6ee7b7" stroke-width="2" marker-end="url(#arrow)" />
  </g>


  <!-- ========================================== -->
  <!-- ZONE 4: DATA PERSISTENCE (BOTTOM)          -->
  <!-- ========================================== -->
  <rect x="80" y="880" width="1260" height="120" rx="16" fill="url(#dataGradient)" stroke="#d8b4fe" stroke-width="2" filter="url(#dropShadow)" />
  <text x="110" y="915" fill="#6b21a8" font-family="sans-serif" font-size="20" font-weight="800" letter-spacing="-0.5">Persistence Layer</text>

  <g transform="translate(440, 915)">
    <rect x="0" y="0" width="200" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="100" y="25" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">trading_agent.db</text>
    <text x="100" y="45" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">Core SQLite (Trades/Signals)</text>
    
    <rect x="250" y="0" width="200" height="60" rx="8" fill="#ffffff" filter="url(#softShadow)" stroke="#e2e8f0" stroke-width="1.5" />
    <text x="350" y="25" fill="#1e293b" font-family="sans-serif" font-size="13" font-weight="700" text-anchor="middle">activity_YYYY_MM.db</text>
    <text x="350" y="45" fill="#64748b" font-family="sans-serif" font-size="11" text-anchor="middle">Monthly Ops (API Logs)</text>
  </g>


  <!-- ========================================== -->
  <!-- GLOBAL CONNECTIONS & ROUTING               -->
  <!-- ========================================== -->

  <!-- UI to FastAPI -->
  <path d="M820,205 L820,310 L748,310" fill="none" stroke="#94a3b8" stroke-width="2" stroke-dasharray="4 4" marker-end="url(#arrow)" />

  <!-- FastAPI to DB -->
  <path d="M740,340 L880,340 L880,880 L620,880 L620,907" fill="none" stroke="#94a3b8" stroke-width="2" stroke-dasharray="4 4" marker-end="url(#arrow)" />
  
  <!-- Backtest to Strategy -->
  <path d="M300,455 L432,455" fill="none" stroke="#2563eb" stroke-width="2" marker-end="url(#arrowSolid)" />
  
  <!-- Orchestrator to Strategy -->
  <path d="M530,490 L530,550" fill="none" stroke="#2563eb" stroke-width="3" marker-end="url(#arrowSolid)" />

  <!-- Data to Strategy -->
  <path d="M300,590 L432,590" fill="none" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)" />
  <path d="M300,670 L400,670 L400,620 L432,620" fill="none" stroke="#94a3b8" stroke-width="2" marker-end="url(#arrow)" />

  <!-- Strategy (Signal) to Broker Router -->
  <path d="M860,720 L960,720 L960,455 L1092,455" fill="none" stroke="#3b82f6" stroke-width="3" marker-end="url(#arrowSolid)" />
  <text x="965" y="600" fill="#2563eb" font-family="sans-serif" font-size="11" font-weight="bold" transform="rotate(-90 965,600)">APPROVED SIGNAL</text>

  <!-- Broker Router to DB -->
  <path d="M1280,455 L1360,455 L1360,945 L648,945" fill="none" stroke="#10b981" stroke-width="2" stroke-dasharray="6 4" marker-end="url(#arrow)" />
  <text x="1350" y="700" fill="#10b981" font-family="sans-serif" font-size="11" font-weight="bold" transform="rotate(90 1350,700)">TRADE RECORDING</text>

</svg>